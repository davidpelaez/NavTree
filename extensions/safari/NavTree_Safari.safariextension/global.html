<!DOCTYPE HTML> 

<script src="jquery162.js" type="text/javascript"></script>
<script src="tabsTable.js" type="text/javascript"></script>
<script>  

//BEHAVIOUR CONSTANTS
NEW_WINDOW = 2;
NEW_TAB_BLANK = 3; 
NEW_TAB_POINTED = 5;
NEW_TAB_ACTIVE = 7;
NEW_TAB_BG = 11; 

var tabsTable = new TabsTable();
var windowsRecord = "WINDOWS!!";

     
 //Track when a window or tab is opened
safari.application.addEventListener("open", openHandler, true); 
safari.application.addEventListener("beforeNavigate", navigationHandler, true);  //Record the intention to go somewhere

function navigationHandler(event){
	console.log("Navigating to somewhere");
	console.log(event);
}                               

function openHandler(event)
{
    // Open events are sent for both windows and tabs. When a tab is opened, keep track of it in
    // the list of unread tabs until it has been read (activated) or closed.
	console.log(windowsRecord);
	jqueryTest();
	console.log(event);
    if (event.target instanceof SafariBrowserTab){
		if(event.target.browserWindow.activeTab == event.target)
			console.log("New tab - Active");
		else
			console.log("New tab - Non Active");
	}else{
		console.log("New Window right after tab event");
	}
	console.log("-------------------");
} 

function jqueryTest(){
	if (jQuery) {  
	    // jQuery is loaded  
		console.log("jQuery is loaded");
	} else {
	    console.log("jQuery is NOT loaded");
	}
}
</script>
